<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ron Smithey - Finance</title>
  <!-- CSS Libraries -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css">
  <link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.css">
  <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
  <link rel="stylesheet" href="./assets/css/style.css">
  <style>
    /* Ensure the html and body fill the viewport */
    html, body {
      height: 100%;
      margin: 0;
    }
    /* Wrapper to keep footer at the very bottom */
    #pageWrapper {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    main {
      flex: 1;
    }
    /* Extra styling for the sections */
    .section-padding {
      padding: 60px 0;
    }
    /* Horizontal navigation buttons (Bootstrap pills) */
    .calc-btn-group {
      margin-bottom: 20px;
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
    }
    .calc-btn-group .nav-link {
      display: flex;
      align-items: center;
      gap: 5px;
      background-color: #28a745;
      color: #fff;
      border: 1px solid #28a745;
      padding: 10px 15px;
      border-radius: 5px;
    }
    .calc-btn-group .nav-link:hover {
      background-color: #218838;
      border-color: #1e7e34;
      color: #fff;
    }
    .calc-btn-group .nav-link.active {
      background-color: #218838;
      border-color: #1e7e34;
      color: #fff;
    }
    /* Buttons for calculator forms */
    .btn-calc {
      background-color: #28a745;
      border-color: #28a745;
      color: #fff;
    }
    .btn-calc:hover {
      background-color: #218838;
      border-color: #1e7e34;
      color: #fff;
    }
    .btn-reset {
      background-color: #6c757d;
      border-color: #6c757d;
      color: #fff;
    }
    .btn-reset:hover {
      background-color: #5a6268;
      border-color: #545b62;
      color: #fff;
    }
    /* Calculator Navigation Cards Styling */
    .calc-nav-card {
      background-color: #2c3136;
      border: none;
      border-radius: 16px;
      transition: all 0.3s ease;
      cursor: pointer;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      position: relative;
      z-index: 1;
      padding-top: 5px;
      margin-bottom: 10px; /* Extra margin for mobile */
    }
    .calc-nav-card::after {
      content: '';
      position: absolute;
      top: 0;
      left: 20%;
      right: 20%;
      height: 5px;
      background: linear-gradient(90deg, rgba(40,167,69,0.1), rgba(40,167,69,0.7), rgba(40,167,69,0.1));
      border-radius: 0 0 5px 5px;
    }
    .calc-nav-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);
      opacity: 0;
      z-index: -1;
      transition: opacity 0.3s ease;
    }
    .calc-nav-card:hover {
      transform: translateY(-7px);
      box-shadow: 0 12px 20px rgba(0,0,0,0.15);
    }
    .calc-nav-card:hover::before {
      opacity: 0.1;
    }
    .calc-nav-card.active {
      background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(40, 167, 69, 0.3);
    }
    .calc-nav-card .icon-wrapper {
      height: 70px;
      width: 70px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: rgba(40, 167, 69, 0.1);
      border-radius: 50%;
      color: #28a745;
      font-size: 2rem;
      transition: all 0.3s ease;
    }
    .calc-nav-card:hover .icon-wrapper {
      transform: scale(1.1);
      background-color: rgba(40, 167, 69, 0.15);
    }
    .calc-nav-card.active .icon-wrapper {
      background-color: rgba(255, 255, 255, 0.2);
      color: #fff;
      transform: scale(1.1);
    }
    .calc-nav-card .card-title {
      margin-top: 15px;
      font-weight: 600;
      color: #e2e2e2;
      transition: color 0.3s ease;
    }
    .calc-nav-card:hover .card-title {
      color: #fff;
    }
    .calc-nav-card.active .card-title {
      color: #fff;
    }
    /* Calculator Navigation Cards - Make more responsive */
    @media (max-width: 991.98px) {
      .calc-nav-card .icon-wrapper {
        height: 60px;
        width: 60px;
        font-size: 1.7rem;
      }
      .calc-nav-card .card-title {
        font-size: 0.95rem;
      }
    }
    @media (max-width: 767.98px) {
      .calc-nav-card {
        max-width: 250px;
        margin-left: auto;
        margin-right: auto;
      }
    }
    /* Back-to-Top Button */
    #backToTop {
      position: fixed;
      bottom: 30px;
      right: 30px;
      display: none;
      z-index: 1050;
      border: none;
      background-color: #28a745;
      color: #fff;
      padding: 15px;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
      transition: all 0.3s ease;
      opacity: 0.9;
    }
    #backToTop i {
      font-size: 1.25rem;
    }
    #backToTop:hover {
      background-color: #218838;
      transform: translateY(-5px);
      box-shadow: 0 6px 15px rgba(0,0,0,0.3);
      opacity: 1;
    }
    /* Budgeting Tools Section Styling */
    #budgetingTools {
      /* Inherit the page's background */
    }
    #budgetingTools .section-header {
      text-align: center;
      margin-bottom: 40px;
    }
    #budgetingTools .card {
      background-color: #343a40; /* Same dark gray as the footer */
      color: #fff;
      border: none;
      border-top: 3px solid #28a745;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    #budgetingTools .card:hover {
      transform: scale(1.03);
      box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    }
    #budgetingTools .card-img-top {
      object-fit: cover;
      height: 200px;
      transition: filter 0.3s ease;
    }
    #budgetingTools .card:hover .card-img-top {
      filter: brightness(0.9);
    }
    #budgetingTools .card-title i {
      font-size: 1.5rem;
      margin-right: 8px;
      vertical-align: middle;
    }
    /* Footer Styling */
    footer {
      background-color: #343a40;
      color: #fff;
      margin: 0;
      padding: 1rem 0;
    }
    .calculator-wrapper {
      max-width: 600px;
      margin: 0 auto;
    }
    
  </style>
</head>
<body data-bs-spy="scroll" data-bs-target=".navbar">
  <div id="pageWrapper">
    <main>
      
      <!-- MAIN NAVBAR (Your original header) -->
      <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container">
          <a class="navbar-brand" href="homepage.html">
            <img src="./assets/images/Designer.png" alt="Logo" width="100" height="50">
          </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="mainNavbar">
            <ul class="navbar-nav ms-auto">
              <li class="nav-item"><a class="nav-link" href="homepage.html">Home</a></li>
              <li class="nav-item"><a class="nav-link" href="resources.html">Resources</a></li>
              <li class="nav-item"><a class="nav-link" href="community.html">Community</a></li>
              <li class="nav-item"><a class="nav-link" href="articles.html">Articles</a></li>
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="legal.html" role="button" data-bs-toggle="dropdown">
                  Legal
                </a>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item" href="legal.html">Private Policies</a></li>
                  <li><a class="dropdown-item" href="Compliance.html">Compliance</a></li>
                </ul>
              </li>
              <li class="nav-item"><a class="nav-link" href="contact.html">Contact Us</a></li>
            </ul>
          </div>
        </div>
      </nav>
      
      <!-- CALCULATOR SECTION WITH HORIZONTAL BUTTON NAVIGATION -->
      <section id="calculators" class="section-padding">
        <div class="container">
          <!-- Calculator Section Heading -->
          <div class="text-center mb-4" data-aos="fade-up">
            <h2 class="h4 fw-bold mb-3 text-white">Calculator Options</h2>
            <p class="text-light mb-4">Choose one of the financial tools below to calculate your goals.</p>
          </div>

          <!-- Replacing horizontal navigation with Card Grid Navigation -->
          <div class="row mb-5" id="calcTab" role="tablist">
            <div class="col-md-3 col-sm-6 mb-4" role="presentation">
              <div class="card h-100 text-center calc-nav-card active" id="loan-tab" data-bs-toggle="pill" data-bs-target="#loanCalc" type="button" role="tab" aria-controls="loanCalc" aria-selected="true">
                <div class="card-body py-4 px-3">
                  <div class="icon-wrapper mb-3">
                    <i class="ri-money-dollar-circle-line"></i>
                  </div>
                  <h5 class="card-title mb-0">Loan Calculator</h5>
                </div>
              </div>
            </div>
            <div class="col-md-3 col-sm-6 mb-4" role="presentation">
              <div class="card h-100 text-center calc-nav-card" id="retirement-tab" data-bs-toggle="pill" data-bs-target="#retirementCalc" type="button" role="tab" aria-controls="retirementCalc" aria-selected="false">
                <div class="card-body py-4 px-3">
                  <div class="icon-wrapper mb-3">
                    <i class="ri-time-line"></i>
                  </div>
                  <h5 class="card-title mb-0">Retirement Calculator</h5>
                </div>
              </div>
            </div>
            <div class="col-md-3 col-sm-6 mb-4" role="presentation">
              <div class="card h-100 text-center calc-nav-card" id="life-tab" data-bs-toggle="pill" data-bs-target="#lifeCalc" type="button" role="tab" aria-controls="lifeCalc" aria-selected="false">
                <div class="card-body py-4 px-3">
                  <div class="icon-wrapper mb-3">
                    <i class="ri-shield-user-line"></i>
                  </div>
                  <h5 class="card-title mb-0">Life Insurance</h5>
                </div>
              </div>
            </div>
            <div class="col-md-3 col-sm-6 mb-4" role="presentation">
              <div class="card h-100 text-center calc-nav-card" id="mortgage-tab" data-bs-toggle="pill" data-bs-target="#mortgageCalc" type="button" role="tab" aria-controls="mortgageCalc" aria-selected="false">
                <div class="card-body py-4 px-3">
                  <div class="icon-wrapper mb-3">
                    <i class="ri-home-4-line"></i>
                  </div>
                  <h5 class="card-title mb-0">Mortgage Calculator</h5>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Calculator Forms Content -->
          <div class="tab-content" id="calcTabContent">
            <!-- Loan Payment Calculator -->
            <div class="tab-pane fade show active" id="loanCalc" role="tabpanel" aria-labelledby="loan-tab">
              <div class="text-center mb-4" data-aos="fade-up">
                <h2 class="display-4 fw-semibold">Loan Payment Calculator</h2>
                <p>Estimate your monthly payments, total interest, and the total amount paid.</p>
              </div>
              <form id="loan-calc-form">
                <div class="mb-3">
                  <label for="loan-amount" class="form-label">Loan Amount ($)</label>
                  <input type="number" step="0.001" class="form-control" id="loan-amount" placeholder="Enter loan amount" min="100" max="10000000" required>
                  <div class="invalid-feedback" id="loan-amountFeedback"></div>
                </div>
                <div class="mb-3">
                  <label for="loan-interest" class="form-label">Annual Interest Rate (%)</label>
                  <input type="number" step="0.001" class="form-control" id="loan-interest" placeholder="Enter interest rate" min="0" max="50" required>
                  <div class="invalid-feedback" id="loan-interestFeedback"></div>
                </div>
                <div class="mb-3">
                  <label for="loan-term" class="form-label">Loan Term</label>
                  <input type="number" step="0.001" class="form-control" id="loan-term" placeholder="Enter loan term" min="1" max="50" required>
                  <select class="form-select mt-2" id="loan-term-type" required>
                    <option value="" disabled selected>Select term type</option>
                    <option value="years">Years</option>
                    <option value="months">Months</option>
                  </select>
                  <div class="invalid-feedback" id="loan-termFeedback"></div>
                </div>
                <button type="submit" class="btn btn-calc w-100">Calculate</button>
                <button type="reset" class="btn btn-reset w-100 mt-3">Reset</button>
              </form>
              <!-- Spinner and Result for Loan Calculator -->
              <div class="spinner-border mt-3" role="status" id="loan-spinner" style="display: none;">
                <span class="visually-hidden">Loading...</span>
              </div>
              <div id="loan-result" class="mt-4 text-center" style="display: none;"></div>
            </div>
            
            <!-- Cost of Retirement Calculator -->
            <div class="tab-pane fade" id="retirementCalc" role="tabpanel" aria-labelledby="retirement-tab">
              <div class="text-center mb-4" data-aos="fade-up">
                <h2 class="display-4 fw-semibold">Cost of Retirement Calculator</h2>
                <p>Estimate the retirement fund you'll need based on your expected expenses at retirement.</p>
              </div>
              <form id="retirement-calc-form">
                <div class="mb-3">
                  <label for="retirement-expense" class="form-label">Current Annual Expense for Retirement ($)</label>
                  <input type="number" step="0.01" class="form-control" id="retirement-expense" placeholder="e.g., 50000" min="1" required>
                  <div class="invalid-feedback" id="retirement-expenseFeedback"></div>
                </div>
                <div class="mb-3">
                  <label for="retirement-years" class="form-label">Years Until Retirement</label>
                  <input type="number" step="0.01" class="form-control" id="retirement-years" placeholder="e.g., 20" min="1" required>
                  <div class="invalid-feedback" id="retirement-yearsFeedback"></div>
                </div>
                <div class="mb-3">
                  <label for="retirement-inflation" class="form-label">Annual Inflation Rate (%)</label>
                  <input type="number" step="0.01" class="form-control" id="retirement-inflation" placeholder="e.g., 2.5" min="0" required>
                  <div class="invalid-feedback" id="retirement-inflationFeedback"></div>
                </div>
                <div class="mb-3">
                  <label for="retirement-withdrawal" class="form-label">Safe Withdrawal Rate (%)</label>
                  <input type="number" step="0.01" class="form-control" id="retirement-withdrawal" placeholder="e.g., 4" min="0" required>
                  <div class="invalid-feedback" id="retirement-withdrawalFeedback"></div>
                </div>
                <button type="submit" class="btn btn-calc w-100">Calculate</button>
                <button type="reset" class="btn btn-reset w-100 mt-3">Reset</button>
              </form>
              <!-- Spinner and Result for Retirement Calculator -->
              <div class="spinner-border mt-3" role="status" id="retirement-spinner" style="display: none;">
                <span class="visually-hidden">Loading...</span>
              </div>
              <div id="retirement-result" class="mt-4 text-center" style="display: none;"></div>
            </div>
            
            <!-- Life Insurance Calculator -->
            <div class="tab-pane fade" id="lifeCalc" role="tabpanel" aria-labelledby="life-tab">
              <div class="text-center mb-4" data-aos="fade-up">
                <h2 class="display-4 fw-semibold">Life Insurance Calculator</h2>
                <p>Estimate how much life insurance coverage you may need.</p>
              </div>
              <form id="life-calc-form">
                <div class="mb-3">
                  <label for="life-income" class="form-label">Annual Income ($)</label>
                  <input type="number" step="0.01" class="form-control" id="life-income" placeholder="Enter annual income" min="1" required>
                  <div class="invalid-feedback" id="life-incomeFeedback"></div>
                </div>
                <div class="mb-3">
                  <label for="life-years" class="form-label">Years of Support Needed</label>
                  <input type="number" step="0.01" class="form-control" id="life-years" placeholder="Enter number of years" min="1" required>
                  <div class="invalid-feedback" id="life-yearsFeedback"></div>
                </div>
                <div class="mb-3">
                  <label for="life-debts" class="form-label">Outstanding Debts ($)</label>
                  <input type="number" step="0.01" class="form-control" id="life-debts" placeholder="Enter total debts" min="0" required>
                  <div class="invalid-feedback" id="life-debtsFeedback"></div>
                </div>
                <div class="mb-3">
                  <label for="life-savings" class="form-label">Current Savings/Assets ($)</label>
                  <input type="number" step="0.01" class="form-control" id="life-savings" placeholder="Enter current savings" min="0" required>
                  <div class="invalid-feedback" id="life-savingsFeedback"></div>
                </div>
                <button type="submit" class="btn btn-calc w-100">Calculate</button>
                <button type="reset" class="btn btn-reset w-100 mt-3">Reset</button>
              </form>
              <!-- Spinner and Result for Life Insurance Calculator -->
              <div class="spinner-border mt-3" role="status" id="life-spinner" style="display: none;">
                <span class="visually-hidden">Loading...</span>
              </div>
              <div id="life-result" class="mt-4 text-center" style="display: none;"></div>
            </div>
            
            <!-- Mortgage Calculator -->
            <div class="tab-pane fade" id="mortgageCalc" role="tabpanel" aria-labelledby="mortgage-tab">
              <div class="text-center mb-4" data-aos="fade-up">
                <h2 class="display-4 fw-semibold">Mortgage Calculator</h2>
                <p>Estimate your monthly mortgage payments and see a breakdown of costs.</p>
              </div>
              <form id="mortgage-calc-form">
                <div class="mb-3">
                  <label for="mortgage-price" class="form-label">Home Price ($)</label>
                  <input type="number" step="0.01" class="form-control" id="mortgage-price" placeholder="Enter home price" min="1000" required>
                  <div class="invalid-feedback" id="mortgage-priceFeedback"></div>
                </div>
                <div class="mb-3">
                  <label for="mortgage-down" class="form-label">Down Payment ($)</label>
                  <input type="number" step="0.01" class="form-control" id="mortgage-down" placeholder="Enter down payment amount" min="0" required>
                  <div class="invalid-feedback" id="mortgage-downFeedback"></div>
                </div>
                <div class="mb-3">
                  <label for="mortgage-term" class="form-label">Loan Term (years)</label>
                  <select class="form-select" id="mortgage-term" required>
                    <option value="" disabled selected>Select loan term</option>
                    <option value="30">30 years</option>
                    <option value="20">20 years</option>
                    <option value="15">15 years</option>
                    <option value="10">10 years</option>
                  </select>
                  <div class="invalid-feedback" id="mortgage-termFeedback"></div>
                </div>
                <div class="mb-3">
                  <label for="mortgage-interest" class="form-label">Interest Rate (%)</label>
                  <input type="number" step="0.001" class="form-control" id="mortgage-interest" placeholder="Enter interest rate" min="0.1" max="25" required>
                  <div class="invalid-feedback" id="mortgage-interestFeedback"></div>
                </div>
                <div class="mb-3">
                  <label for="mortgage-tax" class="form-label">Property Tax ($ / year)</label>
                  <input type="number" step="0.01" class="form-control" id="mortgage-tax" placeholder="Enter annual property tax" min="0">
                  <div class="invalid-feedback" id="mortgage-taxFeedback"></div>
                </div>
                <div class="mb-3">
                  <label for="mortgage-insurance" class="form-label">Home Insurance ($ / year)</label>
                  <input type="number" step="0.01" class="form-control" id="mortgage-insurance" placeholder="Enter annual home insurance" min="0">
                  <div class="invalid-feedback" id="mortgage-insuranceFeedback"></div>
                </div>
                <button type="submit" class="btn btn-calc w-100">Calculate</button>
                <button type="reset" class="btn btn-reset w-100 mt-3">Reset</button>
              </form>
              <!-- Spinner and Result for Mortgage Calculator -->
              <div class="spinner-border mt-3" role="status" id="mortgage-spinner" style="display: none;">
                <span class="visually-hidden">Loading...</span>
              </div>
              <div id="mortgage-result" class="mt-4 text-center" style="display: none;"></div>
            </div>
          </div><!-- end tab-content -->
        </div><!-- end container -->
      </section>
      
      <!-- BUDGETING TOOLS SECTION -->
      <section id="budgetingTools" class="section-padding">
        <div class="container">
          <div class="text-center section-header" data-aos="fade-up">
            <h2 class="display-4 fw-semibold">Budgeting Tools</h2>
            <p class="lead">Manage your money effectively with our budgeting tools.</p>
          </div>
          <div class="row">
            <!-- Budget Planner Card -->
            <div class="col-12 col-md-6 mb-4" data-aos="fade-up" data-aos-delay="100">
              <div class="card h-100 border-0 shadow-sm" style="background-color: #343a40; border-top: 3px solid #28a745;">
                <img src="./assets/images/budgetplanner.png" class="card-img-top" alt="Budget Planner" style="height: 220px; object-fit: cover; object-position: center 30%; border-bottom: 1px solid rgba(255,255,255,0.1);">
                <div class="card-body">
                  <h5 class="card-title"><i class="ri-calculator-fill"></i> Budget Planner</h5>
                  <p class="card-text">Create a monthly budget and monitor your spending to optimize your savings.</p>
                </div>
                <div class="card-footer bg-transparent text-center">
                  <a href="javascript:void(0);" class="btn btn-calc" id="openBudgetPlanner">Try Budget Planner</a>
                </div>
              </div>
            </div>
            <!-- Coming Soon Card (Replacing Expense Tracker) -->
            <div class="col-12 col-md-6 mb-4" data-aos="fade-up" data-aos-delay="200">
              <div class="card h-100 border-0 shadow-sm" style="background-color: #343a40; border-top: 3px solid #28a745;">
                <img src="./assets/images/Expense Tracker.png" class="card-img-top" alt="Expense Tracker" style="height: 220px; object-fit: cover; object-position: center; border-bottom: 1px solid rgba(255,255,255,0.1);">
                <div class="card-body">
                  <h5 class="card-title"><i class="ri-line-chart-fill"></i> Coming Soon</h5>
                  <p class="card-text">New financial tools are in development and will be available in the next update.</p>
                </div>
                <div class="card-footer bg-transparent text-center">
                  <a href="javascript:void(0);" class="btn btn-calc" data-bs-toggle="modal" data-bs-target="#comingSoonModal">Learn More</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      
      <!-- FOOTER -->
      <footer class="text-center py-4">
        <div class="container">
          <p>&copy; 2025 Ron Smithey. All Rights Reserved.</p>
        </div>
      </footer>
    </main>
  </div> <!-- End #pageWrapper -->
  
  <!-- Fixed Back to Top Button (direct HTML approach) -->
  <button id="backToTopFixed" title="Back to Top" style="position: fixed; bottom: 30px; right: 30px; z-index: 99999; width: 50px; height: 50px; border-radius: 50%; background-color: #28a745; color: #fff; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 10px rgba(0,0,0,0.3); transition: all 0.3s ease;">
    <i class="ri-arrow-up-line" style="font-size: 1.25rem;"></i>
  </button>
  
  <!-- Coming Soon Modal -->
  <div class="modal fade" id="comingSoonModal" tabindex="-1" aria-labelledby="comingSoonModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content bg-dark text-light">
        <div class="modal-header border-0">
          <h5 class="modal-title" id="comingSoonModalLabel">Feature Coming Soon</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-center py-4">
          <i class="ri-time-line" style="font-size: 3rem; color: #28a745;"></i>
          <h4 class="my-3">We're Working On It!</h4>
          <p>This feature is currently under development and will be available soon. Please check back later!</p>
        </div>
        <div class="modal-footer border-0 justify-content-center">
          <button type="button" class="btn btn-calc" data-bs-dismiss="modal">Got it</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Budget Planner Modal -->
  <div class="modal fade" id="budgetPlannerModal" tabindex="-1" aria-labelledby="budgetPlannerModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
      <div class="modal-content bg-dark text-light">
        <div class="modal-header border-secondary">
          <h5 class="modal-title" id="budgetPlannerModalLabel">Budget Planner</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <!-- Instructions Panel -->
          <div class="alert bg-dark border border-secondary text-light mb-4" role="alert">
            <h6 class="alert-heading text-success"><i class="ri-information-line me-2"></i>How to Use This Budget Planner</h6>
            <ol class="mb-0 small">
              <li>Enter your income sources and amounts in the <strong>Income</strong> section</li>
              <li>Enter your expenses by category in the <strong>Expenses</strong> section</li>
              <li>Use the dropdown to switch between expense categories</li>
              <li>The summary will update automatically or click <strong>Calculate</strong></li>
              <li>Click <strong>Save Budget</strong> to store your budget for future sessions</li>
            </ol>
          </div>
          
          <!-- Budget Planner Interface -->
          <div class="row">
            <!-- Left Side: Income & Expenses Forms -->
            <div class="col-md-6">
              <!-- Income Section -->
              <div class="card bg-dark border-secondary mb-4">
                <div class="card-header bg-success bg-opacity-25 text-white">
                  <h5 class="mb-0"><i class="ri-money-dollar-circle-line me-2"></i>Income</h5>
                </div>
                <div class="card-body">
                  <form id="incomeForm">
                    <div class="mb-3">
                      <label class="form-label">Enter Your Income Sources</label>
                      <div class="income-item">
                        <div class="input-group mb-2">
                          <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-money-dollar-circle-line"></i></span>
                          <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Income Source (e.g., Salary)" required>
                          <input type="number" class="form-control income-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01" required>
                          <button type="button" class="btn btn-outline-danger delete-income" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                        </div>
                      </div>
                    </div>
                    <button type="button" id="addIncomeBtn" class="btn btn-outline-success w-100">
                      <i class="ri-add-line me-2"></i>Add Another Income Source
                    </button>
                    <div class="small text-muted mt-2">Enter all regular income sources (salary, side gigs, rental income, etc.)</div>
                  </form>
                </div>
              </div>
              
              <!-- Expenses Section -->
              <div class="card bg-dark border-secondary">
                <div class="card-header bg-success bg-opacity-25 text-white">
                  <h5 class="mb-0"><i class="ri-shopping-cart-line me-2"></i>Expenses</h5>
                </div>
                <div class="card-body">
                  <form id="expensesForm">
                    <!-- Expense Categories -->
                    <div class="mb-3">
                      <label class="form-label">Step 1: Select an Expense Category</label>
                      <select id="expenseCategory" class="form-select bg-dark border-secondary text-light">
                        <option value="housing">🏠 Housing</option>
                        <option value="transportation">🚗 Transportation</option>
                        <option value="food">🍔 Food & Groceries</option>
                        <option value="utilities">💡 Utilities</option>
                        <option value="healthcare">🏥 Healthcare</option>
                        <option value="entertainment">🎬 Entertainment</option>
                        <option value="debt">💳 Debt Payments</option>
                        <option value="savings">💰 Savings</option>
                        <option value="other">📦 Other</option>
                      </select>
                      <div class="small text-muted mt-1">After entering expenses in one category, select another to continue.</div>
                    </div>
                    
                    <div class="mt-2 mb-3">
                      <label class="form-label">Step 2: Enter Expenses in This Category</label>
                    </div>
                    
                    <!-- Housing Expenses -->
                    <div class="expense-category-group" id="housing-expenses">
                      <div class="card bg-dark border-secondary mb-3">
                        <div class="card-header bg-dark">
                          <h6 class="mb-0 text-white-50">🏠 Housing Expenses</h6>
                        </div>
                        <div class="card-body py-3">
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-home-4-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Rent/Mortgage" value="Rent/Mortgage" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-government-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Property Taxes" value="Property Taxes" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <button type="button" class="btn btn-outline-secondary btn-sm add-expense mt-2" data-category="housing">
                            <i class="ri-add-line me-2"></i>Add Housing Expense
                          </button>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Transportation Expenses -->
                    <div class="expense-category-group" id="transportation-expenses" style="display:none;">
                      <div class="card bg-dark border-secondary mb-3">
                        <div class="card-header bg-dark">
                          <h6 class="mb-0 text-white-50">🚗 Transportation Expenses</h6>
                        </div>
                        <div class="card-body py-3">
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-car-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Car Payment" value="Car Payment" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-gas-station-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Gas/Fuel" value="Gas/Fuel" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <button type="button" class="btn btn-outline-secondary btn-sm add-expense mt-2" data-category="transportation">
                            <i class="ri-add-line me-2"></i>Add Transportation Expense
                          </button>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Food Expenses -->
                    <div class="expense-category-group" id="food-expenses" style="display:none;">
                      <div class="card bg-dark border-secondary mb-3">
                        <div class="card-header bg-dark">
                          <h6 class="mb-0 text-white-50">🍔 Food & Groceries Expenses</h6>
                        </div>
                        <div class="card-body py-3">
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-shopping-basket-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Groceries" value="Groceries" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-restaurant-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Dining Out" value="Dining Out" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <button type="button" class="btn btn-outline-secondary btn-sm add-expense mt-2" data-category="food">
                            <i class="ri-add-line me-2"></i>Add Food Expense
                          </button>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Utilities Expenses -->
                    <div class="expense-category-group" id="utilities-expenses" style="display:none;">
                      <div class="card bg-dark border-secondary mb-3">
                        <div class="card-header bg-dark">
                          <h6 class="mb-0 text-white-50">💡 Utilities Expenses</h6>
                        </div>
                        <div class="card-body py-3">
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-lightbulb-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Electricity" value="Electricity" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-water-flash-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Water" value="Water" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <button type="button" class="btn btn-outline-secondary btn-sm add-expense mt-2" data-category="utilities">
                            <i class="ri-add-line me-2"></i>Add Utilities Expense
                          </button>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Healthcare Expenses -->
                    <div class="expense-category-group" id="healthcare-expenses" style="display:none;">
                      <div class="card bg-dark border-secondary mb-3">
                        <div class="card-header bg-dark">
                          <h6 class="mb-0 text-white-50">🏥 Healthcare Expenses</h6>
                        </div>
                        <div class="card-body py-3">
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-mental-health-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Insurance" value="Insurance" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-medicine-bottle-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Medications" value="Medications" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <button type="button" class="btn btn-outline-secondary btn-sm add-expense mt-2" data-category="healthcare">
                            <i class="ri-add-line me-2"></i>Add Healthcare Expense
                          </button>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Entertainment Expenses -->
                    <div class="expense-category-group" id="entertainment-expenses" style="display:none;">
                      <div class="card bg-dark border-secondary mb-3">
                        <div class="card-header bg-dark">
                          <h6 class="mb-0 text-white-50">🎬 Entertainment Expenses</h6>
                        </div>
                        <div class="card-body py-3">
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-movie-2-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Streaming Services" value="Streaming Services" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-gamepad-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Hobbies" value="Hobbies" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <button type="button" class="btn btn-outline-secondary btn-sm add-expense mt-2" data-category="entertainment">
                            <i class="ri-add-line me-2"></i>Add Entertainment Expense
                          </button>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Debt Expenses -->
                    <div class="expense-category-group" id="debt-expenses" style="display:none;">
                      <div class="card bg-dark border-secondary mb-3">
                        <div class="card-header bg-dark">
                          <h6 class="mb-0 text-white-50">💳 Debt Payments</h6>
                        </div>
                        <div class="card-body py-3">
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-bank-card-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Credit Card" value="Credit Card" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-book-open-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Student Loan" value="Student Loan" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <button type="button" class="btn btn-outline-secondary btn-sm add-expense mt-2" data-category="debt">
                            <i class="ri-add-line me-2"></i>Add Debt Payment
                          </button>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Savings Expenses -->
                    <div class="expense-category-group" id="savings-expenses" style="display:none;">
                      <div class="card bg-dark border-secondary mb-3">
                        <div class="card-header bg-dark">
                          <h6 class="mb-0 text-white-50">💰 Savings</h6>
                        </div>
                        <div class="card-body py-3">
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-safe-2-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Emergency Fund" value="Emergency Fund" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-funds-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Investments" value="Investments" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <button type="button" class="btn btn-outline-secondary btn-sm add-expense mt-2" data-category="savings">
                            <i class="ri-add-line me-2"></i>Add Savings
                          </button>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Other Expenses -->
                    <div class="expense-category-group" id="other-expenses" style="display:none;">
                      <div class="card bg-dark border-secondary mb-3">
                        <div class="card-header bg-dark">
                          <h6 class="mb-0 text-white-50">📦 Other Expenses</h6>
                        </div>
                        <div class="card-body py-3">
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-shopping-bag-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Personal Care" value="Personal Care" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <div class="expense-item mb-2">
                            <div class="input-group">
                              <span class="input-group-text bg-dark border-secondary text-success"><i class="ri-gift-line"></i></span>
                              <input type="text" class="form-control bg-dark border-secondary text-light" placeholder="Gifts/Donations" value="Gifts/Donations" readonly>
                              <input type="number" class="form-control expense-amount bg-dark border-secondary text-light" placeholder="Amount" min="0" step="0.01">
                              <button type="button" class="btn btn-outline-danger delete-expense" style="display:none;"><i class="ri-delete-bin-line"></i></button>
                            </div>
                          </div>
                          <button type="button" class="btn btn-outline-secondary btn-sm add-expense mt-2" data-category="other">
                            <i class="ri-add-line me-2"></i>Add Other Expense
                          </button>
                        </div>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
            </div>
            
            <!-- Right Side: Budget Summary & Chart -->
            <div class="col-md-6">
              <div class="card bg-dark border-secondary mb-4">
                <div class="card-header bg-success bg-opacity-25 text-white">
                  <h5 class="mb-0"><i class="ri-pie-chart-line me-2"></i>Budget Summary</h5>
                </div>
                <div class="card-body">
                  <div class="alert bg-dark text-light border border-secondary mb-4">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                      <h6 class="mb-0">Total Monthly Income:</h6>
                      <span id="totalIncome" class="text-success fs-5">$0.00</span>
                    </div>
                    <div class="d-flex justify-content-between align-items-center mb-2">
                      <h6 class="mb-0">Total Monthly Expenses:</h6>
                      <span id="totalExpenses" class="text-danger fs-5">$0.00</span>
                    </div>
                    <hr class="border-secondary">
                    <div class="d-flex justify-content-between align-items-center">
                      <h6 class="mb-0 fw-bold">Your Monthly Balance:</h6>
                      <span id="budgetBalance" class="fw-bold fs-4">$0.00</span>
                    </div>
                    <div class="text-center mt-3">
                      <span class="badge bg-success">Click "Calculate" anytime to update</span>
                    </div>
                  </div>
                  
                  <!-- Budget Chart -->
                  <div class="mt-4">
                    <h6 class="text-white-50 mb-3">Your Expense Breakdown</h6>
                    <div class="chart-container" style="position: relative; height: 250px;">
                      <canvas id="budgetChart"></canvas>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Budget Tips Card -->
              <div class="card bg-dark border-secondary">
                <div class="card-header bg-success bg-opacity-25 text-white">
                  <h5 class="mb-0"><i class="ri-lightbulb-line me-2"></i>Budget Tips</h5>
                </div>
                <div class="card-body">
                  <div id="budgetTips">
                    <div class="tip-card p-3 mb-2 rounded bg-dark border border-secondary">
                      <p class="mb-0 small"><i class="ri-information-line me-2 text-success"></i>The 50/30/20 rule suggests spending 50% on needs, 30% on wants, and 20% on savings.</p>
                    </div>
                    <div class="tip-card p-3 mb-2 rounded bg-dark border border-secondary">
                      <p class="mb-0 small"><i class="ri-information-line me-2 text-success"></i>Try to keep housing costs below 30% of your monthly income.</p>
                    </div>
                    <div class="tip-card p-3 rounded bg-dark border border-secondary">
                      <p class="mb-0 small"><i class="ri-information-line me-2 text-success"></i>Save at least 3-6 months of expenses in an emergency fund.</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer border-secondary">
          <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Close</button>
          <button type="button" id="calculateBudgetBtn" class="btn btn-calc">Calculate</button>
          <button type="button" id="saveBudgetBtn" class="btn btn-calc">Save Budget</button>
          <button type="button" id="printBudgetBtn" class="btn btn-outline-secondary">Print</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- JS Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>
  <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="./assets/js/main.js"></script>
  
  <!-- Calculator JavaScript -->
  <script>
    // Utility: Simple validation for numeric input (up to 3 decimals by default)
    function validateInput(id, rawValue, min, max) {
      const numericValue = parseFloat(rawValue);
      const regex = /^\d*(\.\d{0,3})?$/;
      if (isNaN(numericValue) || numericValue < min || numericValue > max || /[eE]/.test(rawValue) || !regex.test(rawValue)) {
        document.getElementById(id).classList.add('is-invalid');
        return false;
      } else {
        document.getElementById(id).classList.remove('is-invalid');
        return true;
      }
    }
    
    // Format as US Currency
    function formatCurrency(amount) {
      return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(amount);
    }
    
    // Prevent scientific notation (optional)
    function preventScientificNotation(event) {
      const allowedKeys = ['Backspace', 'Delete', 'ArrowLeft', 'ArrowRight', 'Enter'];
      if (allowedKeys.includes(event.key)) return;
      if (/[eE]/.test(event.key)) event.preventDefault();
    }
    
    // -------------------------
    // Loan Payment Calculator
    // -------------------------
    document.getElementById('loan-amount').addEventListener('input', preventScientificNotation);
    document.getElementById('loan-interest').addEventListener('input', preventScientificNotation);
    document.getElementById('loan-term').addEventListener('input', preventScientificNotation);
    
    document.getElementById('loan-calc-form').addEventListener('submit', function(event) {
      event.preventDefault();
      let valid = true;
      valid &= validateInput('loan-amount', document.getElementById('loan-amount').value, 100, 10000000);
      valid &= validateInput('loan-interest', document.getElementById('loan-interest').value, 0, 50);
      valid &= validateInput('loan-term', document.getElementById('loan-term').value, 1, 50);
      if (document.getElementById('loan-term-type').value === "") {
        alert("Please select a term type.");
        valid = false;
      }
      if (!valid) return;
      
      const principal = parseFloat(document.getElementById('loan-amount').value);
      const interestRate = parseFloat(document.getElementById('loan-interest').value);
      const term = parseFloat(document.getElementById('loan-term').value);
      const termType = document.getElementById('loan-term-type').value;
      const numberOfPayments = (termType === "years") ? term * 12 : term;
      
      document.getElementById('loan-spinner').style.display = 'inline-block';
      let monthlyPayment;
      if (interestRate === 0) {
        monthlyPayment = principal / numberOfPayments;
      } else {
        const monthlyRate = (interestRate / 100) / 12;
        monthlyPayment = (principal * monthlyRate) / (1 - Math.pow(1 + monthlyRate, -numberOfPayments));
      }
      const totalPaid = monthlyPayment * numberOfPayments;
      const totalInterest = totalPaid - principal;
      document.getElementById('loan-spinner').style.display = 'none';
      document.getElementById('loan-result').innerHTML = `
        <h4>Estimated Monthly Payment: <span>${formatCurrency(monthlyPayment)}</span></h4>
        <p>Total Interest Paid: <span>${formatCurrency(totalInterest)}</span></p>
        <p>Total Amount Paid: <span>${formatCurrency(totalPaid)}</span></p>
      `;
      document.getElementById('loan-result').style.display = 'block';
    });
    
    document.getElementById('loan-calc-form').addEventListener('reset', function() {
      document.getElementById('loan-result').style.display = 'none';
    });
    
    // -------------------------------
    // Cost of Retirement Calculator
    // -------------------------------
    document.getElementById('retirement-expense').addEventListener('input', preventScientificNotation);
    document.getElementById('retirement-years').addEventListener('input', preventScientificNotation);
    document.getElementById('retirement-inflation').addEventListener('input', preventScientificNotation);
    document.getElementById('retirement-withdrawal').addEventListener('input', preventScientificNotation);
    
    document.getElementById('retirement-calc-form').addEventListener('submit', function(event) {
      event.preventDefault();
      let valid = true;
      valid &= validateInput('retirement-expense', document.getElementById('retirement-expense').value, 1, 1000000000);
      valid &= validateInput('retirement-years', document.getElementById('retirement-years').value, 1, 100);
      valid &= validateInput('retirement-inflation', document.getElementById('retirement-inflation').value, 0, 100);
      valid &= validateInput('retirement-withdrawal', document.getElementById('retirement-withdrawal').value, 0.1, 100);
      if (!valid) return;
      
      const expense = parseFloat(document.getElementById('retirement-expense').value);
      const years = parseFloat(document.getElementById('retirement-years').value);
      const inflation = parseFloat(document.getElementById('retirement-inflation').value);
      const withdrawal = parseFloat(document.getElementById('retirement-withdrawal').value);
      
      document.getElementById('retirement-spinner').style.display = 'inline-block';
      const futureExpense = expense * Math.pow((1 + inflation/100), years);
      const requiredNestEgg = futureExpense / (withdrawal/100);
      document.getElementById('retirement-spinner').style.display = 'none';
      document.getElementById('retirement-result').innerHTML = `
        <h4>Future Annual Expense at Retirement: <span>${formatCurrency(futureExpense)}</span></h4>
        <p>Estimated Required Nest Egg (using a ${withdrawal}% withdrawal rate): <span>${formatCurrency(requiredNestEgg)}</span></p>
      `;
      document.getElementById('retirement-result').style.display = 'block';
    });
    
    document.getElementById('retirement-calc-form').addEventListener('reset', function() {
      document.getElementById('retirement-result').style.display = 'none';
    });
    
    // -----------------------------
    // Life Insurance Calculator
    // -----------------------------
    document.getElementById('life-income').addEventListener('input', preventScientificNotation);
    document.getElementById('life-years').addEventListener('input', preventScientificNotation);
    document.getElementById('life-debts').addEventListener('input', preventScientificNotation);
    document.getElementById('life-savings').addEventListener('input', preventScientificNotation);
    
    document.getElementById('life-calc-form').addEventListener('submit', function(event) {
      event.preventDefault();
      let valid = true;
      valid &= validateInput('life-income', document.getElementById('life-income').value, 1, 1000000000);
      valid &= validateInput('life-years', document.getElementById('life-years').value, 1, 100);
      valid &= validateInput('life-debts', document.getElementById('life-debts').value, 0, 1000000000);
      valid &= validateInput('life-savings', document.getElementById('life-savings').value, 0, 1000000000);
      if (!valid) return;
      
      const income = parseFloat(document.getElementById('life-income').value);
      const years = parseFloat(document.getElementById('life-years').value);
      const debts = parseFloat(document.getElementById('life-debts').value);
      const savings = parseFloat(document.getElementById('life-savings').value);
      
      document.getElementById('life-spinner').style.display = 'inline-block';
      let recommendedCoverage = (income * years) + debts - savings;
      if (recommendedCoverage < 0) {
        recommendedCoverage = 0;
      }
      document.getElementById('life-spinner').style.display = 'none';
      document.getElementById('life-result').innerHTML = `
        <h4>Recommended Life Insurance Coverage: <span>${formatCurrency(recommendedCoverage)}</span></h4>
      `;
      document.getElementById('life-result').style.display = 'block';
    });
    
    document.getElementById('life-calc-form').addEventListener('reset', function() {
      document.getElementById('life-result').style.display = 'none';
    });
    
    // -----------------------------
    // Mortgage Calculator
    // -----------------------------
    document.getElementById('mortgage-price').addEventListener('input', preventScientificNotation);
    document.getElementById('mortgage-down').addEventListener('input', preventScientificNotation);
    document.getElementById('mortgage-interest').addEventListener('input', preventScientificNotation);
    document.getElementById('mortgage-tax').addEventListener('input', preventScientificNotation);
    document.getElementById('mortgage-insurance').addEventListener('input', preventScientificNotation);
    
    document.getElementById('mortgage-calc-form').addEventListener('submit', function(event) {
      event.preventDefault();
      let valid = true;
      valid &= validateInput('mortgage-price', document.getElementById('mortgage-price').value, 1000, 100000000);
      valid &= validateInput('mortgage-down', document.getElementById('mortgage-down').value, 0, 100000000);
      valid &= validateInput('mortgage-interest', document.getElementById('mortgage-interest').value, 0.1, 25);
      
      // Optional fields can be 0 or more
      const taxValue = document.getElementById('mortgage-tax').value;
      if (taxValue !== '') {
        valid &= validateInput('mortgage-tax', taxValue, 0, 1000000);
      }
      
      const insuranceValue = document.getElementById('mortgage-insurance').value;
      if (insuranceValue !== '') {
        valid &= validateInput('mortgage-insurance', insuranceValue, 0, 100000);
      }
      
      if (document.getElementById('mortgage-term').value === "") {
        alert("Please select a loan term.");
        valid = false;
      }
      
      if (!valid) return;
      
      const homePrice = parseFloat(document.getElementById('mortgage-price').value);
      const downPayment = parseFloat(document.getElementById('mortgage-down').value);
      const loanTerm = parseInt(document.getElementById('mortgage-term').value);
      const interestRate = parseFloat(document.getElementById('mortgage-interest').value);
      const propertyTax = taxValue !== '' ? parseFloat(taxValue) : 0;
      const homeInsurance = insuranceValue !== '' ? parseFloat(insuranceValue) : 0;
      
      document.getElementById('mortgage-spinner').style.display = 'inline-block';
      
      // Calculate loan amount
      const loanAmount = homePrice - downPayment;
      
      // Calculate monthly mortgage payment (Principal + Interest)
      const monthlyRate = (interestRate / 100) / 12;
      const numberOfPayments = loanTerm * 12;
      let monthlyPayment = 0;
      
      if (interestRate === 0) {
        monthlyPayment = loanAmount / numberOfPayments;
      } else {
        monthlyPayment = (loanAmount * monthlyRate) / (1 - Math.pow(1 + monthlyRate, -numberOfPayments));
      }
      
      // Calculate monthly property tax and insurance
      const monthlyTax = propertyTax / 12;
      const monthlyInsurance = homeInsurance / 12;
      
      // Calculate total monthly payment including tax and insurance
      const totalMonthlyPayment = monthlyPayment + monthlyTax + monthlyInsurance;
      
      // Calculate total interest paid over the life of the loan
      const totalInterest = (monthlyPayment * numberOfPayments) - loanAmount;
      
      document.getElementById('mortgage-spinner').style.display = 'none';
      
      // Display results
      document.getElementById('mortgage-result').innerHTML = `
        <h4>Estimated Monthly Payment: <span>${formatCurrency(totalMonthlyPayment)}</span></h4>
        <div class="row mt-3">
          <div class="col-md-6">
            <p><strong>Principal & Interest:</strong> ${formatCurrency(monthlyPayment)}</p>
            <p><strong>Loan Amount:</strong> ${formatCurrency(loanAmount)}</p>
            <p><strong>Down Payment:</strong> ${formatCurrency(downPayment)}</p>
          </div>
          <div class="col-md-6">
            <p><strong>Property Tax:</strong> ${formatCurrency(monthlyTax)}/month</p>
            <p><strong>Home Insurance:</strong> ${formatCurrency(monthlyInsurance)}/month</p>
            <p><strong>Total Interest Paid:</strong> ${formatCurrency(totalInterest)}</p>
          </div>
        </div>
      `;
      document.getElementById('mortgage-result').style.display = 'block';
    });
    
    document.getElementById('mortgage-calc-form').addEventListener('reset', function() {
      document.getElementById('mortgage-result').style.display = 'none';
    });
    
    // Initialize AOS for animations (if needed)
    AOS.init();
  </script>
  
  <!-- Budget Planner JavaScript -->
  <script>
    // Handle budget planner button click
    document.addEventListener('DOMContentLoaded', function() {
      // Handle budget planner button
      const budgetPlannerBtn = document.getElementById('openBudgetPlanner');
      if (budgetPlannerBtn) {
        budgetPlannerBtn.addEventListener('click', function(e) {
          e.preventDefault();
          const budgetPlannerModal = document.getElementById('budgetPlannerModal');
          if (budgetPlannerModal) {
            const modal = new bootstrap.Modal(budgetPlannerModal);
            
            // Set up one-time initialization
            if (!window.budgetPlannerInitialized) {
              budgetPlannerModal.addEventListener('shown.bs.modal', function() {
                initBudgetPlanner();
              }, { once: true }); // Only run once
              window.budgetPlannerInitialized = true;
            }
            
            modal.show();
          }
        });
      }
      
      // Handle back to top button
      const backToTopBtn = document.getElementById('backToTopFixed');
      if (backToTopBtn) {
        backToTopBtn.addEventListener('click', function() {
          window.scrollTo({ top: 0, behavior: 'smooth' });
        });
      }
    });
    
    // Budget Planner Functionality
    function initBudgetPlanner() {
      console.log("Initializing budget planner");
      
      // ----- DOM Elements -----
      const incomeForm = document.getElementById('incomeForm');
      const expensesForm = document.getElementById('expensesForm');
      const expenseCategory = document.getElementById('expenseCategory');
      const addIncomeBtn = document.getElementById('addIncomeBtn');
      const calculateBudgetBtn = document.getElementById('calculateBudgetBtn');
      const saveBudgetBtn = document.getElementById('saveBudgetBtn');
      const printBudgetBtn = document.getElementById('printBudgetBtn');
      const totalIncomeEl = document.getElementById('totalIncome');
      const totalExpensesEl = document.getElementById('totalExpenses');
      const budgetBalanceEl = document.getElementById('budgetBalance');
      const budgetChartCanvas = document.getElementById('budgetChart');
      
      // Verify all required elements exist
      if (!incomeForm || !expensesForm || !addIncomeBtn || !calculateBudgetBtn) {
        console.error("Critical budget planner elements missing");
        return;
      }
      
      // ----- State Variables -----
      let budgetData = {
        income: [],
        expenses: {
          housing: [],
          transportation: [],
          food: [],
          utilities: [],
          healthcare: [],
          entertainment: [],
          debt: [],
          savings: [],
          other: []
        }
      };
      let budgetChart = null;
      
      // ----- Utility Functions -----
      function formatCurrency(amount) {
        return new Intl.NumberFormat('en-US', { 
          style: 'currency', 
          currency: 'USD' 
        }).format(amount);
      }
      
      // ----- Initialization -----
      function init() {
        // Load saved budget data from localStorage
        loadBudgetData();
        
        // Initialize chart
        initChart();
        
        // Set up event handlers
        setupEventHandlers();
        
        // Show initial data
        renderIncome();
        showExpenseCategory(expenseCategory.value);
        calculateBudget();
      }
      
      // ----- Event Handlers -----
      function setupEventHandlers() {
        // Add income button
        if (addIncomeBtn) {
          addIncomeBtn.addEventListener('click', addIncomeItem);
        }
        
        // Expense category selection
        if (expenseCategory) {
          expenseCategory.addEventListener('change', function() {
            showExpenseCategory(this.value);
          });
        }
        
        // Add expense buttons
        const addExpenseBtns = document.querySelectorAll('.add-expense');
        addExpenseBtns.forEach(btn => {
          btn.addEventListener('click', function() {
            const category = this.dataset.category;
            addExpenseItem(category);
          });
        });
        
        // Calculate budget button
        if (calculateBudgetBtn) {
          calculateBudgetBtn.addEventListener('click', function() {
            collectFormData();
            calculateBudget();
          });
        }
        
        // Save budget button
        if (saveBudgetBtn) {
          saveBudgetBtn.addEventListener('click', function() {
            collectFormData();
            saveBudgetData();
            alert('Budget data saved successfully!');
          });
        }
        
        // Print budget button
        if (printBudgetBtn) {
          printBudgetBtn.addEventListener('click', function() {
            window.print();
          });
        }
        
        // Event delegation for removing income/expense items
        document.addEventListener('click', function(e) {
          if (e.target.closest('.delete-income')) {
            const incomeItem = e.target.closest('.income-item');
            if (incomeItem && incomeItem.parentNode.querySelectorAll('.income-item').length > 1) {
              incomeItem.remove();
            }
          }
          
          if (e.target.closest('.delete-expense')) {
            const expenseItem = e.target.closest('.expense-item');
            if (expenseItem && expenseItem.parentNode.querySelectorAll('.expense-item').length > 2) {
              expenseItem.remove();
            }
          }
        });
      }
      
      // ----- Core Functions -----
      function addIncomeItem() {
        const incomeItems = incomeForm.querySelector('.income-item');
        const newItem = incomeItems.cloneNode(true);
        
        // Clear values
        newItem.querySelectorAll('input').forEach(input => {
          input.value = '';
        });
        
        // Show delete button
        const deleteBtn = newItem.querySelector('.delete-income');
        if (deleteBtn) {
          deleteBtn.style.display = 'block';
        }
        
        // Add to form
        incomeItems.parentNode.appendChild(newItem);
      }
      
      function addExpenseItem(category) {
        const expenseCategoryGroup = document.getElementById(`${category}-expenses`);
        if (!expenseCategoryGroup) return;
        
        const existingItems = expenseCategoryGroup.querySelectorAll('.expense-item');
        if (existingItems.length === 0) return;
        
        const lastItem = existingItems[existingItems.length - 1];
        const newItem = lastItem.cloneNode(true);
        
        // Reset inputs
        const descInput = newItem.querySelector('input[type="text"]');
        const amountInput = newItem.querySelector('input[type="number"]');
        
        if (descInput) {
          descInput.value = '';
          descInput.readOnly = false;
          descInput.placeholder = 'Enter description';
        }
        
        if (amountInput) {
          amountInput.value = '';
        }
        
        // Show delete button
        const deleteBtn = newItem.querySelector('.delete-expense');
        if (deleteBtn) {
          deleteBtn.style.display = 'block';
        }
        
        // Add to form
        const cardBody = lastItem.parentNode;
        cardBody.insertBefore(newItem, cardBody.lastElementChild);
      }
      
      function showExpenseCategory(category) {
        // Hide all categories
        const allCategories = document.querySelectorAll('.expense-category-group');
        allCategories.forEach(cat => {
          cat.style.display = 'none';
        });
        
        // Show selected category
        const selectedCategory = document.getElementById(`${category}-expenses`);
        if (selectedCategory) {
          selectedCategory.style.display = 'block';
        }
      }
      
      function collectFormData() {
        // Collect Income Data
        budgetData.income = [];
        const incomeItems = incomeForm.querySelectorAll('.income-item');
        incomeItems.forEach(item => {
          const sourceInput = item.querySelector('input[type="text"]');
          const amountInput = item.querySelector('.income-amount, input[type="number"]');
          
          if (sourceInput && amountInput && sourceInput.value && amountInput.value) {
            budgetData.income.push({
              source: sourceInput.value,
              amount: parseFloat(amountInput.value) || 0
            });
          }
        });
        
        console.log("Collected income data:", budgetData.income);
        
        // Collect Expense Data
        const categories = Object.keys(budgetData.expenses);
        categories.forEach(category => {
          budgetData.expenses[category] = [];
          
          const categoryGroup = document.getElementById(`${category}-expenses`);
          if (!categoryGroup) return;
          
          const expenseItems = categoryGroup.querySelectorAll('.expense-item');
          expenseItems.forEach(item => {
            const descInput = item.querySelector('input[type="text"]');
            const amountInput = item.querySelector('.expense-amount, input[type="number"]');
            
            if (descInput && amountInput && descInput.value && amountInput.value) {
              budgetData.expenses[category].push({
                description: descInput.value,
                amount: parseFloat(amountInput.value) || 0
              });
            }
          });
        });
        
        console.log("Collected expense data:", budgetData.expenses);
      }
      
      function calculateBudget() {
        collectFormData();
        
        // Calculate total income
        const totalIncome = budgetData.income.reduce((sum, item) => sum + item.amount, 0);
        
        // Calculate total expenses
        let totalExpenses = 0;
        const categories = Object.keys(budgetData.expenses);
        const categoryTotals = {};
        
        categories.forEach(category => {
          const categoryTotal = budgetData.expenses[category].reduce((sum, item) => sum + item.amount, 0);
          categoryTotals[category] = categoryTotal;
          totalExpenses += categoryTotal;
        });
        
        console.log("Category totals:", categoryTotals);
        console.log("Total expenses:", totalExpenses);
        
        // Calculate balance
        const balance = totalIncome - totalExpenses;
        
        // Update UI
        totalIncomeEl.textContent = formatCurrency(totalIncome);
        totalExpensesEl.textContent = formatCurrency(totalExpenses);
        
        // Set balance color based on value
        if (balance >= 0) {
          budgetBalanceEl.className = 'fw-bold fs-4 text-success';
        } else {
          budgetBalanceEl.className = 'fw-bold fs-4 text-danger';
        }
        budgetBalanceEl.textContent = formatCurrency(balance);
        
        // Update chart
        updateChart(totalExpenses);
        
        // Update budget tips
        updateBudgetTips(totalIncome, totalExpenses, balance);
      }
      
      function initChart() {
        if (!budgetChartCanvas) {
          console.log("Budget chart canvas not found");
          return;
        }
        
        // Check if Chart.js is available
        if (typeof Chart === 'undefined') {
          console.error("Chart.js library not found");
          return;
        }
        
        try {
          // Destroy existing chart if it exists
          if (budgetChart) {
            budgetChart.destroy();
          }
          
          // Updated color palette with more distinct colors
          const chartColors = [
            '#28a745', // Green (Housing)
            '#007bff', // Blue (Transportation)
            '#fd7e14', // Orange (Food)
            '#6f42c1', // Purple (Utilities)
            '#e83e8c', // Pink (Healthcare)
            '#ffc107', // Yellow (Entertainment)
            '#dc3545', // Red (Debt)
            '#20c997', // Teal (Savings)
            '#6c757d'  // Gray (Other)
          ];
          
          budgetChart = new Chart(budgetChartCanvas, {
            type: 'doughnut',
            data: {
              labels: [],
              datasets: [{
                data: [],
                backgroundColor: chartColors,
                borderWidth: 1
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  position: 'right',
                  labels: {
                    color: '#e2e2e2',
                    font: {
                      size: 11
                    }
                  }
                },
                tooltip: {
                  callbacks: {
                    label: function(context) {
                      const label = context.label || '';
                      const value = context.raw || 0;
                      const total = context.chart.getDatasetMeta(0).total;
                      const percentage = Math.round((value / total) * 100);
                      return `${label}: ${formatCurrency(value)} (${percentage}%)`;
                    }
                  }
                }
              }
            }
          });
          
          console.log("Budget chart initialized successfully");
        } catch (error) {
          console.error("Error initializing budget chart:", error);
        }
      }
      
      function updateChart(totalExpenses) {
        if (!budgetChart) {
          console.log("Budget chart not initialized, attempting to initialize");
          initChart();
          if (!budgetChart) return;
        }
        
        try {
          const categoryLabels = [];
          const categoryData = [];
          // Updated color palette with more distinct colors
          const categoryColors = [
            '#28a745', // Green (Housing)
            '#007bff', // Blue (Transportation)
            '#fd7e14', // Orange (Food)
            '#6f42c1', // Purple (Utilities)
            '#e83e8c', // Pink (Healthcare)
            '#ffc107', // Yellow (Entertainment)
            '#dc3545', // Red (Debt)
            '#20c997', // Teal (Savings)
            '#6c757d'  // Gray (Other)
          ];
          
          // Color mapping for specific categories to ensure consistency
          const categoryColorMap = {
            'housing': '#28a745',
            'transportation': '#007bff',
            'food': '#fd7e14',
            'utilities': '#6f42c1',
            'healthcare': '#e83e8c',
            'entertainment': '#ffc107',
            'debt': '#dc3545',
            'savings': '#20c997',
            'other': '#6c757d'
          };
                    console.log("Updating chart with expense data:", budgetData.expenses);
          
          // Get expense amounts by category
          const categories = Object.keys(budgetData.expenses);
          
          // First collect all valid categories with expenses
          const validCategories = categories.filter(category => {
            const categoryExpenses = budgetData.expenses[category];
            const categoryTotal = categoryExpenses.reduce((sum, item) => {
              const amount = parseFloat(item.amount) || 0;
              return sum + amount;
            }, 0);
            return categoryTotal > 0;
          });
          
          console.log("Valid categories with expenses:", validCategories);
          
          // Then generate chart data with assigned colors
          const assignedColors = [];
          
          validCategories.forEach((category, index) => {
            const categoryExpenses = budgetData.expenses[category];
            const categoryTotal = categoryExpenses.reduce((sum, item) => {
              const amount = parseFloat(item.amount) || 0;
              return sum + amount;
            }, 0);
            
            console.log(`Category ${category} total: ${categoryTotal}`);
            
            let label = category.charAt(0).toUpperCase() + category.slice(1);
            
            // Add emoji to category
            switch(category) {
              case 'housing': label = '🏠 ' + label; break;
              case 'transportation': label = '🚗 ' + label; break;
              case 'food': label = '🍔 ' + label; break;
              case 'utilities': label = '💡 ' + label; break;
              case 'healthcare': label = '🏥 ' + label; break;
              case 'entertainment': label = '🎬 ' + label; break;
              case 'debt': label = '💳 ' + label; break;
              case 'savings': label = '💰 ' + label; break;
              case 'other': label = '📦 ' + label; break;
            }
            
            categoryLabels.push(label);
            categoryData.push(categoryTotal);
            
            // Assign the mapped color if available, otherwise use the default color array
            if (categoryColorMap[category]) {
              assignedColors.push(categoryColorMap[category]);
            } else {
              assignedColors.push(categoryColors[index % categoryColors.length]);
            }
          });
          
          console.log("Chart data prepared:", {labels: categoryLabels, data: categoryData, colors: assignedColors});
          
          // Handle case with no data
          if (categoryData.length === 0) {
            categoryLabels.push('No Expenses');
            categoryData.push(1);
            assignedColors.push('#6c757d'); // Gray for no data
          }
          
          // Update chart data
          budgetChart.data.labels = categoryLabels;
          budgetChart.data.datasets[0].data = categoryData;
          budgetChart.data.datasets[0].backgroundColor = assignedColors;
          budgetChart.update();
          console.log("Chart updated successfully");
        } catch (error) {
          console.error("Error updating budget chart:", error);
        }
      }
      
      function updateBudgetTips(income, expenses, balance) {
        const tipsContainer = document.getElementById('budgetTips');
        if (!tipsContainer) return;
        
        // Clear existing tips
        tipsContainer.innerHTML = '';
        
        const tips = [];
        
        // Add general tips
        tips.push('The 50/30/20 rule suggests spending 50% on needs, 30% on wants, and 20% on savings.');
        
        // Add specific tips based on budget
        if (balance < 0) {
          tips.push('Your expenses exceed your income. Consider reducing non-essential spending.');
          tips.push('Try to identify areas where you can cut back to balance your budget.');
        } else if (balance === 0) {
          tips.push('Your budget is balanced, but consider setting aside money for savings.');
          tips.push('Even a small emergency fund can help with unexpected expenses.');
        } else {
          tips.push('Great job! You have a positive balance. Consider putting some toward savings or debt reduction.');
          
          // If balance is more than 20% of income
          if (balance > income * 0.2) {
            tips.push('You have a significant surplus. Consider investing or increasing retirement contributions.');
          }
        }
        
        // Housing cost tip
        const housingExpenses = budgetData.expenses.housing.reduce((sum, item) => sum + item.amount, 0);
        if (housingExpenses > income * 0.3) {
          tips.push('Your housing costs exceed 30% of your income, which is higher than recommended.');
        }
        
        // Entertainment/discretionary spending tip
        const entertainmentExpenses = budgetData.expenses.entertainment.reduce((sum, item) => sum + item.amount, 0);
        if (entertainmentExpenses > income * 0.15) {
          tips.push('Your entertainment budget is relatively high. Consider if some of this could be redirected to savings.');
        }
        
        // Add tips to UI (limit to 3)
        tips.slice(0, 3).forEach(tip => {
          const tipCard = document.createElement('div');
          tipCard.className = 'tip-card p-3 mb-2 rounded bg-dark border border-secondary';
          tipCard.innerHTML = `<p class="mb-0 small"><i class="ri-information-line me-2 text-success"></i>${tip}</p>`;
          tipsContainer.appendChild(tipCard);
        });
      }
      
      function loadBudgetData() {
        const savedData = localStorage.getItem('budgetPlannerData');
        if (savedData) {
          try {
            budgetData = JSON.parse(savedData);
            console.log("Loaded budget data from localStorage");
            
            // Populate the form with saved data
            renderIncome();
            renderExpenses();
          } catch (error) {
            console.error("Error loading budget data:", error);
          }
        }
      }
      
      function saveBudgetData() {
        localStorage.setItem('budgetPlannerData', JSON.stringify(budgetData));
        console.log("Budget data saved to localStorage");
      }
      
      function renderIncome() {
        // Clear existing income items except the first one
        const incomeItems = incomeForm.querySelectorAll('.income-item');
        for (let i = 1; i < incomeItems.length; i++) {
          incomeItems[i].remove();
        }
        
        // Reset the first income item
        const firstItem = incomeItems[0];
        if (firstItem) {
          const sourceInput = firstItem.querySelector('input[type="text"]');
          const amountInput = firstItem.querySelector('.income-amount, input[type="number"]');
          
          if (sourceInput) sourceInput.value = '';
          if (amountInput) amountInput.value = '';
        }
        
        // Add income items from saved data
        budgetData.income.forEach((income, index) => {
          if (index === 0 && firstItem) {
            // Use the first item for the first income
            const sourceInput = firstItem.querySelector('input[type="text"]');
            const amountInput = firstItem.querySelector('.income-amount, input[type="number"]');
            
            if (sourceInput) sourceInput.value = income.source;
            if (amountInput) amountInput.value = income.amount;
          } else {
            // Add new items for additional incomes
            addIncomeItem();
            
            const newItems = incomeForm.querySelectorAll('.income-item');
            const newItem = newItems[newItems.length - 1];
            
            const sourceInput = newItem.querySelector('input[type="text"]');
            const amountInput = newItem.querySelector('.income-amount, input[type="number"]');
            
            if (sourceInput) sourceInput.value = income.source;
            if (amountInput) amountInput.value = income.amount;
            
            // Show delete button
            const deleteBtn = newItem.querySelector('.delete-income');
            if (deleteBtn) {
              deleteBtn.style.display = 'block';
            }
          }
        });
      }
      
      function renderExpenses() {
        const categories = Object.keys(budgetData.expenses);
        
        categories.forEach(category => {
          const expenses = budgetData.expenses[category];
          if (expenses.length === 0) return;
          
          // Get the expense category group
          const categoryGroup = document.getElementById(`${category}-expenses`);
          if (!categoryGroup) return;
          
          // Clear existing expense items except the predefined ones
          const existingItems = categoryGroup.querySelectorAll('.expense-item');
          const defaultCount = existingItems.length;
          
          // Reset default items
          for (let i = 0; i < Math.min(defaultCount, expenses.length); i++) {
            const item = existingItems[i];
            const descInput = item.querySelector('input[type="text"]');
            const amountInput = item.querySelector('.expense-amount, input[type="number"]');
            
            if (amountInput) amountInput.value = expenses[i].amount;
          }
          
          // Add additional items as needed
          for (let i = defaultCount; i < expenses.length; i++) {
            addExpenseItem(category);
            
            const newItems = categoryGroup.querySelectorAll('.expense-item');
            const newItem = newItems[newItems.length - 1];
            
            const descInput = newItem.querySelector('input[type="text"]');
            const amountInput = newItem.querySelector('.expense-amount, input[type="number"]');
            
            if (descInput) descInput.value = expenses[i].description;
            if (amountInput) amountInput.value = expenses[i].amount;
            
            // Show delete button
            const deleteBtn = newItem.querySelector('.delete-expense');
            if (deleteBtn) {
              deleteBtn.style.display = 'block';
            }
          }
        });
      }
      
      // Start the budget planner
      init();
    }
  </script>
</body>
</html>

